// prisma/schema.prisma

datasource db {
  provider = "postgresql"
  url      = "postgres://postgres.wnabcnsdmnxybzgpggqh:Markgoldbridge@123@aws-0-ap-south-1.pooler.supabase.com:5432/postgres"
}

generator client {
  provider = "prisma-client-js"
}

model SupabaseAuthUser {
  id       String    @id @map(name: "id")
  email    String?   @unique
  meals    Meal[]
}

model Meal {
  id           Int          @id @default(autoincrement())
  name         String
  description  String
  imageUrl     String
  day          String
  userId       String      
  user         SupabaseAuthUser @relation(fields: [userId], references: [id])
  ingredients  Ingredient[] @relation("MealToIngredient")
  
  ingredientLinks MealToIngredient[]
}

model Ingredient {
  id      Int     @id @default(autoincrement())
  name    String
  meals   Meal[]  @relation("MealToIngredient")
  // Add opposite relation field
  mealLinks MealToIngredient[]
}

model MealToIngredient {
  mealId      Int
  ingredientId Int

  meal        Meal        @relation(fields: [mealId], references: [id])
  ingredient  Ingredient  @relation(fields: [ingredientId], references: [id])

  @@id([mealId, ingredientId])
}
